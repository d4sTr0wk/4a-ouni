<!DOCTYPE html>
<!-- saved from url=(0115)https://informatica.cv.uma.es/pluginfile.php/572653/mod_resource/content/2/PracticaOpenfiler/PracticaOpenfiler.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

  
  <title>Práctica 8: Uso de un servidor iSCSI para
montar un sistema SAN/NAS</title>


</head>


<body>

<h1 style="text-align: center;"> <b style=""><span style="font-size: 18pt;"></span></b></h1>

<table style="width: 1098px; height: 155px;" border="0">

  <tbody>

    <tr>

      <td style="width: 21.25px;"><img style="width: 99px; height: 93px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/uma.png"><br>

      </td>

      <td style="width: 1164.97px;">
      <h1 style="text-align: center;"><b style=""><span style="font-size: 18pt;">Práctica 8: Uso de un
servidor iSCSI para montar un sistema SAN/NAS&nbsp;</span></b></h1>

      </td>

      <td style="width: 21.25px;"> <img style="width: 99px; height: 93px;" title="dac" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/dac.png"> </td>

    </tr>

  </tbody>
</table>

<h2>1. Objetivo</h2>

En una práctica anterior hemos usado un servidor Samba para
configurar un servidor NAS, que usaba&nbsp;File I/O sobre una red
TCP/IP para, vía protocolo SMB, exportar
volúmenes de disco a uno o más ordenadores
cliente. En esta práctica vamos a configurar un servidor SAN
que, mediante el protocolo iSCSI, use Block I/O sobre una red TCP/IP
para exportar volúmenes de disco a uno o más
clientes. <br>

<br>

En particular, en esta práctica usaremos el servidor iSCSI
Openfiler, por ser open-source (y por tanto de libre uso), y porque su
interfaz de administración simplificará
considerablemente entender qué estamos haciendo.
Adicionalmente, el servidor Openfiler permite también la
exportación de volúmenes de disco como NAS, lo
que nos servirá para ver cómo se puede montar,
con un sólo servidor, un sistema mixto SAN/NAS. Sin embargo,
debe también mencionarse que la implementación
iSCSI de Openfiler tiene ciertas limitaciones técnicas que
no hacen su uso recomendable en sistemas con fuerte tráfico
y/o mucha concurrencia.<br>

<br>

<h2>2 Implementación - exportación iSCSI</h2>

En esta práctica vamos a usar máquinas virtuales
tanto para el servidor iSCSI Openfiler como para los clientes que
accederán a sus volúmenes de disco, conectados a
través de la red host-only. Además de simplificar
la implementación de la práctica (que puede
montarse usando un único ordenador), esta
configuración también sirve para ilustrar una
configuración usada con frecuencia: el empleo de un servidor
iSCSI para proporcionar almacenamiento de disco a máquinas
virtuales a través de sus interfaces virtuales de red.<br>

<br>

Para realizar la práctica seguiremos estos pasos:<br>

<br>

<span style="font-weight: bold;">1)</span> Ir al
directorio <span style="font-style: italic;">D:\perif</span>
,y crear la carpeta <span style="font-style: italic;">Openfiler</span>.<br>

<br>

<span style="font-weight: bold;">2)</span> Abrir
VMware Workstation, y seleccionar <span style="font-weight: bold;">Crear
una nueva máquina virtual</span>. Seleccionar la
configuración <span style="font-weight: bold;">Custom</span>.<br>

<br>

<span style="font-weight: bold;">3)</span> Crear la
máquina virtual usando las opciones de
configuración mostradas en las siguientes figuras:<br>

<br>

<br>

<table style="width: 100%; text-align: left; margin-left: auto; margin-right: auto;" border="0" cellpadding="2" cellspacing="2">

  <tbody>

    <tr>

      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 426px; height: 322px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/wizard-1.png"></td>

      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 411px; height: 83px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/wizard-2.png"></td>

    </tr>

    <tr>

      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 430px; height: 279px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/wizard-3.png"></td>

      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 427px; height: 230px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/wizard-4.png"></td>

    </tr>

    <tr>

      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 428px; height: 383px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/wizard-5.png"></td>

      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 424px; height: 325px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/wizard-6.png"></td>

    </tr>

    <tr>

      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 433px; height: 279px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/wizard-7.png"></td>

      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 429px; height: 156px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/wizard-8.png"></td>

    </tr>

    <tr>

      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 426px; height: 191px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/wizard-9.png"></td>

      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 429px; height: 267px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/wizard-10.png"></td>

    </tr>

    <tr>

      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 430px; height: 328px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/wizard-11.png"></td>

      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 425px; height: 170px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/wizard-12.png"></td>

    </tr>

  </tbody>
</table>

<br>

<br>

<span style="font-weight: bold;">4)</span> Pulsar <span style="font-weight: bold;">Finish</span> para terminar
el proceso y crear la máquina con la
configuración definida.<br>

<br>

Antes de arrancar la máquina virtual, introduciremos en su
unidad de DVD virtual el disco con el instalador de Openfiler.<br>

<br>

<span style="font-weight: bold;">5)</span> Pulsar
sobre la opción <span style="font-weight: bold;">Edit
virtual machine settings</span><br>

<br>

<img style="width: 263px; height: 174px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/open_settings.png"><br>

<br>

<span style="font-weight: bold;">6)</span>
Seleccionar la unidad de CD/DVD, y conectarle la imagen ISO <span style="font-style: italic;">D:\perif\openfileresa-2.99.1-x86_64-disc1.iso</span>&nbsp;
.Pulsar <span style="font-weight: bold;">OK</span><br>

<br>

<img style="width: 680px; height: 337px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/iso_openfiler.png"><br>

<br>

<span style="font-weight: bold;">7)</span> Pulsar <span style="font-weight: bold;">Power on</span> para
arrancar la máquina virtual. Pulsar <span style="font-weight: bold;">Enter</span> para entrar en
el instalador gráfico. Una vez aparezca la pantalla inicial
del instalador de Openfiler, pulsar <span style="font-weight: bold;">Next</span>.<br>

<br>

<span style="font-weight: bold;">8)</span>
Seleccionar teclado español. Pulsar <span style="font-weight: bold;">Next</span>.
Aparecerá un mensaje avisando que se va a borrar el disco
entero; confirmar la operación, pulsando <span style="font-weight: bold;">Yes</span>.
<br>

<br>

Ahora debemos particionar el disco duro, incluyendo el espacio que
dedicaremos a volúmenes de datos. La razón de
tener que hacer ahora esta partición es que, una vez
instalado Openfiler, su software de administración tiene una
herramienta de particionado, pero no funciona correctamente con el
disco virtual creado por esta versión y
configuración del VMware Workstation.<br>

<br>

<span style="font-weight: bold;">9)</span> Para
hacer el particionado manual, marcar la opción <span style="font-weight: bold;">Review and modify partitioning
layout</span>, y pulsar <span style="font-weight: bold;">Next</span>.
Confirmar que queremos borrar todas las particiones de <span style="font-style: italic;">sda</span>, pulsando <span style="font-weight: bold;">Yes</span>.<br>

<br>

<img style="width: 802px; height: 536px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/review_layout.png"><br>

<br>

El esquema propuesto para las particiones del sistema (<span style="font-style: italic;">/boot, /, swap</span>) es
válido; lo que vamos a hacer es añadir una
partición, usando espacio libre del disco, sobre la que
luego montaremos los volúmenes de disco que exportaremos,
respectivamente, sobre iSCSI y sobre protocolos NAS.<br>

<br>

<span style="font-weight: bold;">10)</span> Pulsar <span style="font-weight: bold;">New</span> para crear una
nueva partición. Darle la configuración mostrada
en la figura. Pulsar <span style="font-weight: bold;">OK</span>.<br>

<br>

<img style="width: 505px; height: 443px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/particion.png"><br>

<br>

<span style="font-weight: bold;">11)</span>
Necesitamos inicializar esta partición como volumen LVM.
Pulsar sobre el botón <span style="font-weight: bold;">LVM</span>,
y darle la configuración de la figura. Pulsar <span style="font-weight: bold;">OK</span>.<br>

<br>

<img style="width: 544px; height: 443px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/volume_group.png"><br>

<br>

<span style="font-weight: bold;">12)</span> La
configuración final de particiones quedará como
muestra la figura. Pulsar <span style="font-weight: bold;">Next</span>.<br>

<br>

<img style="width: 781px; height: 228px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/config_final_particiones.png"><br>

<br>

<span style="font-weight: bold;">13)</span> Aceptar
la opción por defecto para cargar el EXTLINUX boot loader en
<span style="font-style: italic;">/dev/sda</span>
.Pulsar <span style="font-weight: bold;">Next</span><br>

<br>

<span style="font-weight: bold;">14)</span>
Configuraremos manualmente la dirección IP, pulsando el
botón <span style="font-weight: bold;">Edit</span>.<br>

<br>

<img style="width: 502px; height: 139px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/edit_eth0.png"><br>

<br>

<span style="font-weight: bold;">15)</span> Como es
un servidor, su dirección IP debe ser previsible y fija, por
lo que la configuraremos manualmente a <span style="font-weight: bold;">10.0.0.20/255.255.255.0</span>
.Pulsar <span style="font-weight: bold;">OK</span>.<br>

<br>

<img style="width: 538px; height: 434px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/config_ip.png"><br>

<br>

<span style="font-weight: bold;">16)</span> Dar <span style="font-weight: bold;">openfilerserver</span> como
hostname a la máquina. Pulsar <span style="font-weight: bold;">Next</span>. Confirmar que
no queremos configurar ni el gateway ni el DNS primario, pulsando <span style="font-weight: bold;">Continue</span><br>

<br>

<img style="width: 510px; height: 121px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/hostname.png"><br>

<br>

<span style="font-weight: bold;">17)</span>
Seleccionar el huso horario correcto. Pulsar <span style="font-weight: bold;">Next</span>.<br>

<br>

<img style="width: 306px; height: 158px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/huso_horario.png"><br>

<br>

<span style="font-weight: bold;">18)</span> Entrar <span style="font-weight: bold;">practicas</span> como
password de root. Pulsar <span style="font-weight: bold;">Next</span>
dos veces, para que comience la instalación.<br>

<br>

<span style="font-weight: bold;">19)</span> Cuando
termine la instalación, pulsar <span style="font-weight: bold;">Reboot</span> para iniciar
el servidor Openfiler. <span style="font-style: italic;">(NOTA:
Pulsando "ESC" durante el arranque del servidor Openfiler permite ver
en la consola los mensajes del kernel)</span><br>

<br>

Antes de configurar el servidor iSCSI, vamos a crear dos
máquinas XP adicionales, que usaremos como clientes iSCSI
(es decir, como iniciadores SCSI). Para ello vamos a crear dos clones
enlazados de la máquina virtual XP que hemos usado en el
laboratorio; el emplear clones enlazados nos va a permitir tener tres
máquinas XP distintas (el original, y los dos clones) con un
consumo&nbsp;de disco poco mayor al de una sóla
máquina XP.<br>

<br>

<span style="font-weight: bold;">20)</span> Crear
los directorios <span style="font-style: italic;">D:\perif\XP1</span>
y <span style="font-style: italic;">D:\perif\XP2</span><br style="font-style: italic;">

<br>

<span style="font-weight: bold;">21)</span> En el
VMware Workstation, abrir (pero NO arrancar) la máquina
virtual <span style="font-style: italic;">XP_Agilent_16900_laboratorio</span><br>

<br>

<span style="font-weight: bold;">22)</span>
Seleccionar el menú <span style="font-weight: bold;">VM
-&gt; Manage -&gt; Clone</span> para abrir el Wizard.
Pulsar <span style="font-weight: bold;">Siguiente</span>.<br>

<br>

<span style="font-weight: bold;">23)</span>
Seleccionar como origen del clonado la instantánea indicada
en la figura. Pulsar <span style="font-weight: bold;">Siguiente</span>.<br>

<br>

<img style="width: 421px; height: 241px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/clone_source.png"><br>

<br>

<span style="font-weight: bold;">24)</span>
Seleccionar <span style="font-weight: bold;">linked clone</span>
como tipo de clon. Pulsar <span style="font-weight: bold;">Siguiente</span><br>

<br>

<img style="width: 425px; height: 251px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/tipo_clon.png"><br>

<br>

<span style="font-weight: bold;">25)</span> Darle
como nombre <span style="font-weight: bold;">XP1</span>,
y como directorio destino&nbsp;<span style="font-style: italic;">D:\perif\XP1</span>
.Pulsar <span style="font-weight: bold;">Finalizar</span><br>

<br>

<img style="width: 429px; height: 197px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/nombre_xp1.png"><br>

<br>

<span style="font-weight: bold;">26)</span> Volver a
seleccionar la máquina virtual <span style="font-weight: bold;">Laboratorio ArqAlm</span>,
y repetir el mismo procedimiento de clonado, pero usando ahora como
nombre <span style="font-weight: bold;">XP2</span>,
y como directorio destino <span style="font-style: italic;">D:\perif\XP2</span>
<br>

<br>

Como la máquina XP original toma la dirección por
DHCP, los clones se pueden arrancar sin que aparezca un conflicto de
IPs; sin embargo, las tres máquinas tienen ahora el mismo
nombre NetBIOS (<span style="font-style: italic;">xpvirtual</span>),
así que iremos arrancando uno a uno los dos clones para
cambiar su nombre de equipo.<br>

<br>

<span style="font-weight: bold;">27)</span> Arrancar
la máquina <span style="font-weight: bold;">XP1</span>.
En <span style="font-weight: bold;">Mi PC -&gt;
Propiedades</span>, cambiar el nombre de equipo a <span style="font-weight: bold;">XP1</span>.<br>

<br>

<img style="width: 331px; height: 418px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/cambio_nombre_XP1.png"><br>

<br>

<span style="font-weight: bold;">28)</span>
Reiniciar la máquina. Abrir un <span style="font-weight: bold;">cmd</span>, y obtener con <span style="font-weight: bold;">ipconfig</span>&nbsp;su
dirección IP (que será de la forma 10.0.0.x).
Anotar esta dirección IP.<br>

<br>

<span style="font-weight: bold;">29)</span> Arrancar
ahora la máquina <span style="font-weight: bold;">XP2</span>.
Cambiar su nombre de equipo a <span style="font-weight: bold;">XP2</span>,
y reiniciarla.<br>

<br>

<img style="width: 329px; height: 415px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/cambio_nombre_XP2.png"><br>

<br>

<span style="font-weight: bold;">30)</span> Una vez
reiniciada XP2, abrir en ella un <span style="font-weight: bold;">cmd</span>,
obtener con <span style="font-weight: bold;">ipconfig</span>
su dirección IP, y anotarla.<br>

<br>

Una vez creadas las máquinas que operarán como
clientes,
vamos a crear en el servidor Openfiler la siguiente
configuración:<br>

<br>

<ol>

  <li>Un espacio de disco para Block I/O, constituído
por una
diana iSCSI que exporte 3 LUNs (LUN0, LUN1 y LUN2), en forma de 3
discos SCSI, cada uno de 200 MB. La diana usará LUN Mapping
y
reglas de control de acceso ACL que permitan que cada una de las LUNs
sea visible simultáneamente desde XP1 y XP2.<br>

  </li>

  <li>Un espacio de disco para File I/O, en forma de un volumen
ext4
que sea exportado vía CIFS y NFS a todas las
máquinas de
la subred 10.0.0.0/255.255.255.0 (esto se hará en la segunda
parte de la práctica).</li>

</ol>

Openfiler tiene un interfaz web de administración;
necesitaremos
abrirlo desde el Windows 7 (porque el Firefox de los XP es una
versión demasiado antigua, y falla la
autenticación).<br>

<br>

<span style="font-weight: bold;">31)</span> Abrir
Firefox en el Windows 7, y acceder a la URL <span style="font-weight: bold;">https://10.0.0.20:446</span>.
Aceptar la excepción de seguridad, y hacer login con el
usuario por defecto de Openfiler (username: <span style="font-weight: bold;">openfiler</span>, password <span style="font-weight: bold;">password</span>). <span style="font-style: italic;">(NOTA:
Obviamente, los passwords que estamos usando en esta
práctica no
son seguros, y no deben nunca emplearse en un sistema en
producción real)</span><br>

<br>

<span style="font-weight: bold;">32)</span> El
primer paso será
crear los tres volúmenes de datos que exportaremos como LUNs
SCSI. Para ello, pulsar en la pestaña <span style="font-weight: bold;">Volumes</span> y, una vez
en ella, seleccionar el menú <span style="font-weight: bold;">Add Volume</span><br>

<br>

<img style="width: 904px; height: 253px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/add_volume.png"><br>

<br>

<span style="font-weight: bold;">33)</span> Crear el
primer volumen con los datos mostrados en la figura<br>

<br>

<img style="width: 645px; height: 662px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/volumen1.png"><br>

<br>

<span style="font-weight: bold;">34)</span> Repetir
la operación para crear el segundo volumen, usando los datos
de la figura.<br>

<br>

<img style="width: 660px; height: 666px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/volumen2.png"><br>

<br>

<span style="font-weight: bold;">35)</span>
Finalmente, repetir la operación para crear el tercer
volumen, usando los datos de la figura<br>

<br>

<img style="width: 661px; height: 650px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/volumen3.png"><br>

<br>

Tras ejecutar estas operaciones obtendremos el resultado mostrado en la
figura, con los tres espacios de disco listos para exportar como LUNs
SCSI.<br>

<br>

<img style="width: 767px; height: 615px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/volumes_en_disco.png"><br>

<br>

<span style="font-weight: bold;">36)</span> Ahora
crearemos la diana
SCSI a través de la que el servidor ofrecerá
estas LUNs.
Continuaremos en la pestaña <span style="font-weight: bold;">Volumes</span>, y elegimos
la opción <span style="font-weight: bold;">iSCSI
Targets</span><br>

<br>

<img style="width: 960px; height: 251px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/iscsi_targets.png"><br>

<br>

Al aparecer la nueva pantalla veremos que la gestión del
target
iSCSI está deshabilitada porque, por defecto, el servidor
Openfiler tiene deshabilitado el servicio que proporciona la
funcionalidad de Target iSCSI.<br>

<br>

<span style="font-weight: bold;">37)</span> Para
activar el servicio, pulsamos sobre la pestaña <span style="font-weight: bold;">Services</span>, y
modificamos el estado del servicio <span style="font-weight: bold;">iSCSI
Target</span>, seleccionando <span style="font-weight: bold;">Enabled</span>
y <span style="font-weight: bold;">Start</span>.<br>

<br>

<img style="width: 676px; height: 442px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/servicios_iscsi.png"><br>

<br>

<span style="font-weight: bold;">38)</span>&nbsp;Volvemos
a la pestaña <span style="font-weight: bold;">Volumes</span>
y seleccionamos <span style="font-weight: bold;">iSCSI
Targets</span>. Como vemos, el sistema nos ha creado un
identificador único (<span style="font-style: italic;">Target
IQN</span>)
para la diana. En este caso, sin embargo, como sabemos que no
habrán colisiones de identificadores, lo cambiamos al valor
mostrado en la figura y pulsamos <span style="font-weight: bold;">Add</span>.<br>

<br>

<img style="width: 382px; height: 144px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/nombre_diana.png"><br>

<br>

<span style="font-weight: bold;">39)</span> Pulsamos
sobre la pestaña <span style="font-weight: bold;">LUN
Mapping</span>
para acceder a la ventana en la que podremos asociar los
volúmenes de disco que hemos creado antes con
números de
LUN a ser ofrecidas desde la diana SCSI. Configurar los tres
volúmenes de disco, asignándoles los
parámetros
que se muestran en la primera figura, y pulsar para cada uno <span style="font-weight: bold;">Map</span> (empezando por <span style="font-style: italic;">Disco1</span> y terminando
por <span style="font-style: italic;">Disco3</span>),
lo que dará como resultado la asignación de LUN
IDs mostrada en la segunda figura.<br>

<br>

<br>

<table style="width: 100%; text-align: left; margin-left: auto; margin-right: auto;" border="0" cellpadding="2" cellspacing="2">

  <tbody>

    <tr>

      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 873px; height: 222px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/parametros_luns.png"></td>

    </tr>

    <tr>

      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 845px; height: 228px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/luns_mapeadas.png"></td>

    </tr>

  </tbody>
</table>

<br>

<br>

Para que las LUNs sean visibles desde la red deberemos
también configurar las ACLs (<span style="font-style: italic;">Access Control List = Listas de
Control de Acceso</span>), es decir, el cortafuegos del servidor
Openfiler. El sistema Openfiler utiliza identificadores de subredes
para gestionar las ACLs, por lo que necesitamos crear estos
identificadores antes de poder usarlos en las ACLs del servidor iSCSI.<br>

<br>

<span style="font-weight: bold;">40)</span> En la
pestaña <span style="font-weight: bold;">System</span>,
añadir un identificador de subred usando la
configuración mostrada en la figura (sustituyendo la
dirección IP del ejemplo con la que tenga nuestra
máquina
virtual <span style="font-weight: bold;">XP1</span>,
y que ya anotamos previamente en el punto 28). Pulsar <span style="font-weight: bold;">Update</span>.<br>

<br>

<img style="width: 540px; height: 164px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/acl_xp1.png"><br>

<span style="font-weight: bold;">41)</span> Repetir
la operación para la dirección de la
máquina virtual <span style="font-weight: bold;">XP2</span>.<br>

<br>

<img style="width: 541px; height: 208px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/acl_xp2.png"><br>

<br>

<span style="font-weight: bold;">42)</span> Volver a
<span style="font-weight: bold;">Volumes -&gt; iSCSI
Targets</span>, y pulsar en la pestaña <span style="font-weight: bold;">Network ACL</span>. Cambiar
a <span style="font-weight: bold;">Allow</span> el
permiso de acceso para la red <span style="font-weight: bold;">red-externa</span>,
y pulsar <span style="font-weight: bold;">Update</span>.<br>

<br>

<img style="width: 772px; height: 210px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/acl_target.png"><br>

<br>

Ya hemos terminado la configuración de la diana iSCSI. Ahora
vamos a configurar los clientes (iniciadores) iSCSI. Para ello,
instalaremos en XP1 y XP2 el software que proporciona el iniciador
iSCSI <span style="font-style: italic;">(NOTA: En las
versiones
profesionales de Windows 7 o posterior el iniciador iSCSI viene ya
incluído en el sistema operativo)</span>.<br>

<br>

<span style="font-weight: bold;">43)</span> En el
Windows 7, copiar el fichero <span style="font-style: italic;">X:\Windows_iSCSI_initiator.zip</span>
al directorio <span style="font-style: italic;">D:\perif,</span>
y descomprimirlo. Copiar el fichero <span style="font-style: italic;">Initiator-2.08-build3825-x86fre.exe</span>
al escritorio tanto de XP1 como de XP2.<br>

<br>

<span style="font-weight: bold;">44)</span> En <span style="font-weight: bold;">XP1</span>, ejecutar el
fichero e instalar el software, aceptando todas las opciones ofrecidas
por defecto. Repetir en <span style="font-weight: bold;">XP2</span>.<br>

<br>

<span style="font-weight: bold;">45)</span> En <span style="font-weight: bold;">XP1</span>, abrir el
iniciador iSCSI usando el accedo directo que aparecerá en su
escritorio.<br>

<br>

<span style="font-weight: bold;">46)</span> En la
pestaña <span style="font-weight: bold;">Discovery</span>,
pulsar <span style="font-weight: bold;">Add</span>
e instroducir la dirección <span style="font-weight: bold;">10.0.0.20</span><br>

<br>

<img style="width: 398px; height: 460px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/discovery.png"><br>

<br>

<span style="font-weight: bold;">47)</span> Pulsando
sobre la pestaña <span style="font-weight: bold;">Targets</span>
podemos ver que el iniciador iSCSI ha escaneado
automáticamente al servidor iSCSI en la dirección
IP y puerto proporcionados, y ha descubierto la presencia del Target
iSCSI que hemos definido en Openfiler<br>

<br>

<img style="width: 401px; height: 458px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/targets.png"><br>

<br>

<span style="font-weight: bold;">48)</span>
Necesitamos conectarnos al
servidor para poder usar el target SCSI descubierto por el escaneo
automático. Para ello, pulsamos el botón <span style="font-weight: bold;">Log On</span>, y <span style="font-weight: bold;">OK</span> en la ventana que
aparecerá. El estado del target pasará a <span style="font-style: italic;">Connected</span>.<br>

<br>

<span style="font-weight: bold;">49)</span> Pulsando
en <span style="font-weight: bold;">Details</span>
se abrirá una ventana en la que podremos acceder a
información detallada acerca de las LUNs ofrecidas por este
Target iSCSI. En particular, pulsando en la pestaña <span style="font-weight: bold;">Devices</span> podemos
comprobar que el Target iSCSI nos está ofreciendo tres
discos
iSCSI. Si seleccionamos cualquiera de ellos, y pulsamos <span style="font-weight: bold;">Advanced</span>,
obtendremos información de bajo nivel acerca de ese disco,
siendo la más interesante el número de LUN que
declara
(que será el mismo que le hemos asignado al hacer el LUN
Mapping
en Openfiler).<br>

<br>

<br>

<table style="width: 100%; text-align: left; margin-left: auto; margin-right: auto;" border="0" cellpadding="2" cellspacing="2">

  <tbody>

    <tr>

      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 399px; height: 463px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/devices.png"></td>

      <td style="text-align: center; vertical-align: middle;"><img style="border: 1px solid ; width: 403px; height: 265px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/advanced.png"></td>

    </tr>

  </tbody>
</table>

<br>

<span style="font-weight: bold;">50)</span> Pulsar <span style="font-weight: bold;">Aceptar</span> hasta cerrar
la ventana del iniciador iSCSI.<br>

<br>

Ya tenemos visibles los tres discos SCSI, pero si pulsamos sobre <span style="font-weight: bold;">Mi PC</span>
comprobaremos que estos tres discos no nos aparecen todavía
como
unidades de disco accesibles por el usuario. Para poder utilizarlas es
necesario inicializar los discos, usando el administrador de discos del
XP.<br>

<br>

<span style="font-weight: bold;">51)</span> Pulsar
sobre <span style="font-weight: bold;">Mi PC</span>
y
usar el botón derecho para invocar el menú <span style="font-weight: bold;">Administrar</span>. Pulsar
sobre <span style="font-weight: bold;">Administracion de
discos</span>. Como hay discos sin inicializar (los discos
iSCSI), se abrirá la ventana del Asistente para inicializar
discos. Como queremos gestionar de forma totalmente manual los discos,
pulsaremos <span style="font-weight: bold;">Cancelar</span>.
Se abrirá entonces la ventana del Administrador de discos,
donde podemos ver que hay dos discos sin inicializar, cada uno de ellos
de 200 MB.<span style="font-weight: bold;"></span><span style="font-weight: bold;"></span><br>

<br>

<img style="width: 787px; height: 560px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/admin_discos.png"><br>

<br>

<span style="font-weight: bold;">52)</span> Si
pulsamos sobre la etiqueta del <span style="font-weight: bold;">Disco
1</span> y, con el botón derecho, invocamos el
menú <span style="font-weight: bold;">Propiedades</span>,
podemos comprobar que se trata de la LUN 0 del Target iSCSI ofrecido
por el servidor Openfiler. Pulsar <span style="font-weight: bold;">Cancelar</span>
para volver.<br>

<br>

<img style="width: 446px; height: 446px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/props_disco1.png"><br>

<br>

<span style="font-weight: bold;">53)</span>
Seleccionando la etiqueta del <span style="font-weight: bold;">Disco
1</span>, invocamos con el botón derecho el
menú <span style="font-weight: bold;">Inicializar
disco</span>. Se abrirá una ventana en la que se nos
ofrece elegir los discos a inicializar; seleccionar sólo <span style="font-weight: bold;">Disco 1</span>, y pulsar <span style="font-weight: bold;">Aceptar</span>.<br>

<br>

<img style="width: 398px; height: 242px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/elige_disco1.png"><br>

<br>

<span style="font-weight: bold;">54)</span> Una vez
inicializado, seleccionar el espacio no asignado de <span style="font-weight: bold;">Disco 1</span> y, con el
botón derecho, crear una nueva partición. Aceptar
los parámetros por defecto del particionador, excepto en la
ventana de parámetros de formateo, donde seleccionaremos la
opción <span style="font-weight: bold;">dar
formato rápido</span>. Pulsar <span style="font-weight: bold;">Finalizar.<br>

<br>

<img style="width: 511px; height: 381px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/formato_rapido.png"><br>

<br>

<span style="font-weight: bold;">55)</span></span>
Cerramos el administrador de discos, y comprobamos que ahora tenemos
accesible un nuevo disco duro, de 200 MB de tamaño, en la
unidad lógica F.<br>

<br>

<span style="font-weight: bold;">56)</span> Hacer
doble click sobre <span style="font-style: italic;">F:</span>
para abrirlo, y copiar a <span style="font-style: italic;">F:\
</span>el fichero <span style="font-style: italic;">C:\disktective.exe</span><br>

<br>

<img style="width: 136px; height: 163px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/disktective.png"><br>

<br>

<span style="font-weight: bold;">57)</span> Ir ahora
a la
máquina virtual XP2, abrir el iniciador iSCSI y repetir el
procedimiento que hemos hecho en XP1 para conectarse al servidor iSCSI
10.0.0.20<br>

<br>

<span style="font-weight: bold;">58)</span> Observar
que ahora, sin
necesidad de ir al administrador de discos, nos ha aparecido una unidad
F. Abrirla y comprobar que es el mismo disco que hemos formateado en
XP1, y que ya contiene el fichero <span style="font-style: italic;">disktective.exe</span>.<br>

<br>

<span style="font-weight: bold;">59)</span> Abrir el
administrador de
discos, y comprobar que desde XP2 se ven, en efecto, tres discos, de
los cuales uno está ya inicializado.<br>

<br>

Obviamente, XP1 y XP2 están montando el mismo disco iSCSI
(correspondiente a la LUN0) como unidad F. Sin embargo esta
compartición NO es coherente, y llevará
inevitablemente a
corrupción de datos en cuanto se empiece a usar el disco por
ambos ordenadores.<br>

<br>

<br>

<br>

<span style="font-weight: bold; text-decoration: underline;">Ejercicio
1</span><span style="text-decoration: underline;">:</span>
Comprobar (copiando, y borrando, ficheros en las unidades F de XP1 y
XP2) que, efectivamente, el estado del sistema de fichero en F queda
incoherente al operar desde ambos ordenadores con él.<br>

<br>

<span style="text-decoration: underline;"><span style="font-weight: bold;">Ejercicio 2:</span></span>
Usando un segundo target iSCSI en el servidor Openfiler, y las ACLs
asociadas, reconfigurar la asignación y visibilidad de las
LUNs
SCSI para conseguir la siguiente configuración:<br>

<ol>

  <li><span style="font-style: italic;">&nbsp;Disco1</span>
solo será visible desde XP1.<br>

  </li>

  <li><span style="font-style: italic;">Disco2</span>
solo será visible desde XP2.<br>

  </li>

  <li><span style="font-style: italic;">Disco3</span>
será visible desde ambos XP.</li>

</ol>

Formatear los tres discos como particiones NTFS. Comprobar que ahora
sólo <span style="font-style: italic;">Disco3</span>
presentará problemas de coherencia.<br>

<br>

<h2>3&nbsp;Implementación - servidor NAS</h2>

En el punto anterior hemos visto cómo configurar el servidor
iSCSI de Openfiler para, usando Block I/O, exportar
volúmenes de disco como LUNs de una diana SCSI, y hemos
visto también cómo estas LUNs esran montadas como
discos SCSI en los ordenadores clientes, mediante el uso de un
iniciador iSCSI.<br>

<br>

Ahora, en este punto, vamos a ver cómo configurar el
servidor Openfiler para que opere como NAS, es decir, que exporte
volúmenes de disco en modo File I/O a través de
la red, usando un protocolo de compartición de ficheros.
Para realizar esta configuración, seguiremos los pasos que
se describirán a continuación (<span style="font-style: italic;">nótese que la
numeración continúa la empleada en el apartado 2</span>).
La práctica comienza en el estado en que terminó
el punto 2, con el servidor Openfiler encendido y exportando LUNs SCSI
a los clientes XP1 y XP2, que estarán usando el iniciador
iSCSI para acceder a estas LUNs y montarlas como unidades
lógicas.<br>

<br>

<span style="font-weight: bold;">60)</span> Abrir
Firefox en el Windows 7, y hacer login en la herramienta de
administración de Openfiler (caso de que no estuviera ya
abierta).<br>

<br>

<span style="font-weight: bold;">61)</span> Pulsando
en la pestaña <span style="font-weight: bold;">Volumes</span>,
creamos en Openfiler el volumen de disco que compartiremos por red.
Pulsar <span style="font-weight: bold;">Add Volume</span>,
y crear un nuevo volumen con los parámetros mostrados en la
figura.<br>

<br>

<img style="width: 609px; height: 289px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/volumen_cifs.png"><br>

Tras crear este nuevo volumen, la descripción del grupo de
volúmenes <span style="font-style: italic;">EspacioDatos</span>
quedará como muestra la figura.<br>

<br>

<img style="width: 870px; height: 634px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/espaciodatos_cifs.png"><br>

<br>

Observar que, a diferencia de los volúmenes <span style="font-style: italic;">disco1</span> a <span style="font-style: italic;">disco3</span> (que son
exportados como dispositivos de bloques para ser usados como discos
SCSI), el volumen <span style="font-style: italic;">discocifs</span>
sí es gestionado en el propio servidor Openfiler usando un
sistema de ficheros (Ext4). Es la presencia de este sistema de
ficheros, junto con el software de exportación CIFS/NFS, lo
que permitirá a este volumen ser accedido de forma
simultánea y coherente desde diversos ordenadores.<br>

<br>

<span style="font-weight: bold;">66)</span> Ahora
vamos a activar los servicios de compartición por red, tanto
para Windows (CIFS) como para Unix (NFS). Pulsando sobre la
pestaña <span style="font-weight: bold;">Services</span>,
activar y arrancar los servicios y <span style="font-weight: bold;">CIFS
Server</span> &nbsp;y &nbsp;<span style="font-weight: bold;">NFS Server</span><br>

<br>

<img style="width: 557px; height: 240px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/services_cifs.png"><br>

<br>

<span style="font-weight: bold;">63)</span>
Pulsar&nbsp;ahora sobre la pestaña <span style="font-weight: bold;">Shares</span>.
Podemos observar que el volumen <span style="font-weight: bold;">discocifs</span>
ya está listo para configurar (ignorar el aviso solicitando
crear un nuevo volumen de sistema de ficheros).<br>

<br>

<img style="width: 491px; height: 162px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/filesystem_volume.png"><br>

<br>

<span style="font-weight: bold;">64)</span>
Vamos&nbsp;a
crear un subdirectorio en el volumen, para luego exportarlo como Share.
Pulsar sobre <span style="font-weight: bold;">Disco para
CIFS</span>. Introducir <span style="font-weight: bold;">CarpetaCompartida</span>
como nombre de folder, y pulsar <span style="font-weight: bold;">Enter</span>
o <span style="font-weight: bold;">Create Sub-folder</span>.
Comprobar que se ha creado el subdirectorio especificado, tal como
muestra la figura.<br>

<br>

<img style="width: 571px; height: 141px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/subdir_cifs.png"><br>

<br>

<span style="font-weight: bold;">65)</span> Pulsar
sobre <span style="font-weight: bold;">CarpetaCompartida</span>.
Se abrirá una ventana; pulsar <span style="font-weight: bold;">Make Share</span>.<br>

<br>

<img style="width: 377px; height: 268px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/make_share.png"><br>

<br>

Supongamos que nuestro objetivo es que el directorio <span style="font-style: italic;">CarpetaCompartida</span>
sea un espacio común, no seguro, para el intercambio, dentro
de una oficina, de ficheros no confidenciales. Vamos a configurar el
share con los parámetros que proporcionen esta funcionalidad.<br>

<br>

<span style="font-weight: bold;">66)</span> Una vez
abierta la ventana de configuración del share, seleccionamos
como modo de control <span style="font-weight: bold;">Public
guest access</span>, y pulsamos <span style="font-weight: bold;">Update</span>.<br>

<br>

<img style="width: 256px; height: 165px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/public_access.png"><br>

<br>

<span style="font-weight: bold;">67)</span> Ahora
vamos a exportar este directorio en modo RW (para que pueda ser
leído y escrito) tanto desde máquinas Windows,
usando CIFS, como desde máquinas Unix, usando NFS. Primero,
exportaremos la carpeta a XP1 y XP2: en la sección <span style="font-weight: bold;">Host access configuration</span>,
marcar la opción <span style="font-weight: bold;">RW</span>
para CIFS para XP1 y XP2, y pulsar <span style="font-weight: bold;">Update</span>.<br>

<br>

<img style="width: 798px; height: 342px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/access_xp1_xp2.png"><br>

<br>

<span style="font-weight: bold;">68)</span>
Comprobamos el resultado para XP1: en su menú <span style="font-weight: bold;">Inicio</span>, ejecutar <span style="font-weight: bold;">\\10.0.0.20</span>.
Aparecerá rápidamente una ventana con los
recursos compartidos por el servidor Openfiler, en la que veremos el
share CIFS <span style="font-style: italic;">CarpetaCompartida</span>.
Entrar en esta carpeta, y copiar a ella el directorio <span style="font-style: italic;">c:\jfilesync</span>
completo.<br>

<br>

<img style="width: 427px; height: 92px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/carpetacompartida_xp1.png"><br>

<br>

<span style="font-weight: bold;">69)</span> Ir ahora
a la máquina XP2 y, en su menú <span style="font-weight: bold;">Inicio</span>, ejecutar <span style="font-weight: bold;">\\10.0.0.20</span>.
Comprobar que aparece también el share <span style="font-style: italic;">CarpetaCompartida</span>,
y que contiene en su interior la carpeta <span style="font-style: italic;">jfilesync</span>.<br>

<br>

Ahora, vamos a compartir esta carpeta también con una
máquina Linux, usando el protocolo NFS. Para ello usaremos
la máquina <span style="font-style: italic;">SuseTexto</span>,
que hemos empleado en una práctica anterior, y que
está configurada con la IP estática 10.0.0.2<br>

<br>

<span style="font-weight: bold;">70)</span> Arrancar
la máquina virtual <span style="font-weight: bold;">SuseTexto</span>.
Cuando termine su inicialización, hacer en ella login como <span style="font-weight: bold;">root</span>, con el
password <span style="font-weight: bold;">practicas</span>.
Ejecutar <span style="font-weight: bold;">ifconfig</span>
para asegurarnos de que su dirección IP es, en efecto,
10.0.0.2<br>

<br>

<span style="font-weight: bold;">71)</span> En el
Windows 7 ir a la herramienta de administración de
Openfiler, pulsar en la pestaña <span style="font-weight: bold;">System</span>, y
añadir un identificador de subred para la máquina
<span style="font-weight: bold;">SuseTexto</span>,
usando la configuración mostrada en la figura.<br>

<br>

<img style="width: 499px; height: 41px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/susetexto_access.png"><br>

<br>

<span style="font-weight: bold;">72)</span> Volver a
la pestaña <span style="font-weight: bold;">Shares</span>,
pulsar sobre <span style="font-weight: bold;">CarpetaCompartida</span>
y permitir a <span style="font-weight: bold;">SuseTexto</span>
el acceso en modo RW vía NFS, como muestra la figura. Pulsar <span style="font-weight: bold;">Update</span>.<br>
<br>
<img style="width: 810px; height: 367px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/acl_susetexto.png"><br>
<br>
<span style="font-weight: bold;">73)</span> Volver a la consola de <span style="font-weight: bold;">SuseTexto</span>. Necesitamos crear un punto de montaje para la carpeta compartida; ejecutamos para ello <span style="font-weight: bold;">mkdir /compartida</span> <br>
<br>
<span style="font-weight: bold;">74)</span> Como queremos que la carpeta sea pública, hacemos <span style="font-weight: bold;">chmod 777 /compartida</span>
para darle permisos RW a todos (<span style="font-style: italic;">NOTA:
en una red no 100% segura, dejar un directorio con estos permisos es
una MUY mala idea</span>).<br>
<br>
<span style="font-weight: bold;">75)</span> Necesitaremos saber cual es
la ruta al directorio compartido, dentro del servidor Openfiler.
Podemos ver esta ruta en la pestaña <span style="font-weight: bold;">Shares</span>, en el título <span style="font-style: italic;">Edit Share ...</span><br>
<br>
<img style="width: 567px; height: 271px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/edit_share.png"><br>
<br>
<span style="font-weight: bold;">76)</span> Podemos 
ver esta ruta también en el fichero de
configuración de la exportación NFS del Openfiler
(y, de paso, ver qué es lo que cambiamos desde la
aplicación gráfica). Hacer login como <span style="font-weight: bold;">root</span> en el servidor
Openfiler y ejecutar <span style="font-weight: bold;">more
/etc/exports</span> .La salida nos muestra la ruta con que se
está exportando la carpeta, la ACL que limita su visibilidad
a la subred 192.168.60.0, y las opciones de exportación NFS,
cuyo significado puede encontrarse en la página man de <span style="font-style: italic;">nfs(5)</span>.<br>
<br>
<img style="width: 719px; height: 202px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/exports.png"><br>
<br>
Vamos ahora a configurar en SuseTexto el cliente NFS, añadiendo al fichero <span style="font-style: italic;">fstab</span> el punto de montaje correspondiente. Para ello usaremos la herramienta YAST (<span style="font-style: italic;">porque,
en esta versión de Suse, por la forma como han personalizado los
ficheros de configuración, usar manualmente el comando mount
para montar el directorio NFS, o modificar manualmente dichos ficheros
de configuración da como resultado errores</span>).<br>
<br>
<span style="font-weight: bold;">77)</span> Volver a la consola de <span style="font-weight: bold;">SuseTexto</span>, y ejecutar el comando <span style="font-weight: bold;">yast</span>.<br>
<br>
<span style="font-weight: bold;">78)</span> Seleccionar <span style="font-weight: bold;">Network Services -&gt; NFS Client</span> y pulsar <span style="font-weight: bold;">Enter</span>. Con el tabulador, activar <span style="font-weight: bold;">Add</span> y pulsar <span style="font-weight: bold;">Enter</span>.<br>
<br>
<span style="font-weight: bold;">79)</span> Rellenar el recuadro que aparecerá con los datos mostrados en la figura (<span style="font-style: italic;">NOTA: la ruta a Remote File System puede obtenerse automáticamente usando <span style="font-weight: bold;">Select</span> una vez hayamos definido <span style="font-weight: bold;">10.0.0.20</span> como servidor NFS</span>).<br>
<br>
<img style="width: 477px; height: 141px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/yast_nfs.png"><br>
<br>
<span style="font-weight: bold;">80)</span> Con el tabulador y Enter, activar y seleccionar <span style="font-weight: bold;">OK</span> y luego <span style="font-weight: bold;">Finish</span>. Seleccionar finalmente <span style="font-weight: bold;">Quit</span>.ç<br>
<br>
<span style="font-weight: bold;">81)</span> Ejecutar <span style="font-weight: bold;">more /etc/fstab</span> .Comprobar que se ha añadido al fichero la línea con los parámetros para el comando <span style="font-style: italic;">mount</span> que montará el directorio remoto NFS en el punto de montaje <span style="font-style: italic;">/compartida</span> <br>
<br>
<img style="width: 777px; height: 243px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/fstab_nfs.png"><br>
<br>
<span style="font-weight: bold;">82)</span> Ejecutar ahora <span style="font-weight: bold;">df</span>. Comprobaremos que el espacio de disco NFS ya ha sido montado por Yast, al reiniciar el servicio Cliente NFS.<br>
<br>
<img style="width: 551px; height: 95px;" alt="" src="./Práctica 8_ Uso de un servidor iSCSI para montar un sistema SAN_NAS_files/df_nfs.png"><br>
<br>
<span style="font-weight: bold;">83)</span> Ejecutar <span style="font-weight: bold;">umount /compartida</span>, y luego <span style="font-weight: bold;">df</span> .Comprobaremos que se ha desmontado el volumen NFS. Ejecutar <span style="font-weight: bold;">mount /compartida</span>, y luego <span style="font-weight: bold;">df</span> .Comprobaremos que el sistema ha usado los parámetros de <span style="font-style: italic;">fstab</span> para volver a montar el directorio NFS sobre el punto de montaje <span style="font-style: italic;">/compartida</span><br>
<br>
<span style="font-weight: bold;">84)</span> Ejecutar
<span style="font-weight: bold;">cd&nbsp; /compartida</span>,
y luego <span style="font-weight: bold;">ls -l</span>
.Comprobaremos que desde este Linux podemos ver, vía NFS, el
subdirectorio <span style="font-style: italic;">jfilesync</span>
que hemos copiado desde el Windows vía CIFS.<br>
<br>
<span style="font-weight: bold;">85)</span> Ejecutar
<span style="font-weight: bold;">cp&nbsp; /etc/hosts</span> . .El fichero <span style="font-style: italic;">hosts</span>
del servidor Debianpasarela se copiará a la carpeta
compartida NFS. Comprobarlo ejecutando <span style="font-weight: bold;">ls -l</span> <br>
<br>
<span style="font-weight: bold;">86)</span>&nbsp;Volver
ahora a XP1 y comprobar que, en la carpeta compartida CIFS, ahora
es visible el fichero <span style="font-style: italic;">hosts</span>.
Abrirlo con Textpad para comprobar su contenido. Cerrar el editor sin
modificar el fichero.<br>
<br>
<span style="font-weight: bold;">87)</span> Ahora ir a la consola de Openfiler y ejecutar <span style="font-weight: bold;">ls -l /mnt/EspacioDatos/discocifs/CarpetaCompartida</span> .Este es, realmente,  el volumen de disco y sistema de ficheros (Ext4)
donde residen físicamente los ficheros contenidos en la
carpeta exportada por NAS.<br>
<br>
Con ésto, termina la práctica.<br>

<br>

<br>

<br>



</body></html>